<!-- /sections/footer.liquid -->

{% assign logoImageWidth = section.settings.logo_image_width | append: "px" %}

<footer class="site-footer-wrapper {% if section.settings.image %} site-footer-wrapper--image{% endif%}" role="contentinfo" data-section-id="{{ section.id }}" data-section-type="footer">
  {%- if section.settings.image -%}
    {%- assign img_object = section.settings.image -%}
    {%- assign img_small = section.settings.image | img_url: '18x' -%}
    {%- assign img_api = section.settings.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
    <div class="footer__image wide-image"
      id="FeaturedImage-{{ section.id }}"
      data-parallax-src="{{ img_small }}"
      data-parallax-alt="{{ section.settings.image.alt }}"
      data-src="{{ img_api }}"
      data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048, 2450, 2700, 3000, 3350, 3750, 4100]"
      data-aspectratio="{{  section.settings.image.aspect_ratio }}"
      data-sizes="auto">
    </div>
  {%- endif -%}
  <div class="site-footer">
    <div class="footer__secondary__nav__mobile small-">
      <ul>
        {% for link in linklists[section.settings.footer_secondary_linklist].links %}
          <li><a href="{{ link.url }}">{{ link.title }}</a></li>
        {% endfor %}
      </ul>
    </div>

    {% if section.settings.footer_logo %}
    <style>
      .footer__logo img { width: {{ logoImageWidth }}; }
    </style>
    <a href="{{ routes.root_url }}" class="footer__logo">
      <img src="{{ section.settings.footer_logo | img_url: 'x200' }}" alt="{{ section.settings.footer_logo.alt | default: shop.name }}" id="footerLogoImg-{{ section.id }}"/>
    </a>
    {% endif %}
    <div class="grid grid--uniform footer-top">

      {% case section.blocks.size %}
        {% when 0 %}
        {% when 1 %}
          {% assign footer_column_width = 'large-up--one-half' %}
        {% when 2 %}
          {% assign footer_column_width = 'medium-up--one-half' %}
        {% when 3 %}
          {% assign footer_column_width = 'large-up--one-third' %}
        {% when 4 %}
          {% assign footer_column_width = 'large-up--one-quarter medium--one-half' %}
      {% endcase %}

      {% for block in section.blocks %}
        {%- liquid
          assign content_align = block.settings.content_align
          assign block_order = block.settings.order
        -%}
        {% case block.type %}

          {% when 'linklist' %}
            {% assign linklist = linklists[block.settings.linklist] %}
            <div class="footer__block grid__item {{ footer_column_width }} text-{{content_align}}" {{ block.shopify_attributes }}>
              <h2 class="h5 footer__block__title caps ">{{ linklist.title }} </h2>

              <ul class="footer__quicklinks unstyled">
                {% for link in linklist.links %}
                  <li><a href="{{ link.url }}">{{ link.title }}</a></li>
                {% endfor %}
              </ul>
            </div>

          {% when 'page' %}
            {% assign page = pages[block.settings.page] %}
            {% if page == blank or page.empty? %}
              <div class="footer__block grid__item {{ footer_column_width }} text-{{content_align}}" {{ block.shopify_attributes }}>
                <h2 class="h5 footer__block__title caps">{{ shop.name }}</h2>

                <div class="rte">{{ 'home_page.onboarding.no_content' | t }}</div>
              </div>
            {% else %}
              <div class="footer__block grid__item {{ footer_column_width }}" {{ block.shopify_attributes }}>
                <h2 class="h5 footer__block__title caps">{{ page.title | escape }}</h2>

                <div class="rte">{{ page.content }}</div>
              </div>
            {% endif %}

          {% when 'social' %}
            <div class="footer__block grid__item {{ footer_column_width }} text-{{content_align}}" {{ block.shopify_attributes }}>
              {%- assign social_accounts = 'Facebook, Twitter, Pinterest, Instagram, Tumblr, YouTube, Vimeo,' | split: ', ' -%}
              <h2 class="h5 footer__block__title caps">{{ block.settings.title | escape }}</h2>

              {% if block.settings.richtext != '<p></p>' %}
                <div class="rte footer__social__text">
                  {{ block.settings.richtext }}
                </div>
              {% endif %}
              <ul class="footer__social unstyled inline-list">
                {% render 'social-icon' for social_accounts as social %}
              </ul>
            </div>

          {% when 'text' %}
            <div class="footer__block grid__item {{ footer_column_width }} text-{{content_align}}" {{ block.shopify_attributes }}>
              <h2 class="h5 footer__block__title caps">{{ block.settings.title | escape }}</h2>

              <div class="rte">{{ block.settings.text }}</div>
            </div>

          {% when 'newsletter' %}
            <div class="footer__block footer-newsletter grid__item {{ footer_column_width }} content-{{content_align}}" {{ block.shopify_attributes }}>
              <h2 class="h5 footer__block__title caps text-{{content_align}}">{{ 'layout.footer.newsletter_title' | t }}</h2>

              <div class="rte footer__newsletter__text">
                {{ block.settings.richtext }}
              </div>
              {% comment %}

                <form action="https://gmail.us20.list-manage.com/subscribe/post-json?u=92a297e6af9f562d7dc528124&amp;id=98e4b77137&amp;c=?" method="post" id="mc-embedded-subscribe-form" class="form-inline form-subscribe klaviyo_styling" target="_blank" novalidate="novalidate">
                  <input type="hidden" name="g" value="https://gmail.us20.list-manage.com/subscribe/post-json?u=92a297e6af9f562d7dc528124&amp;id=98e4b77137&amp;c=?">
                  <input required="" type="email" class="form-control" value="" name="email" placeholder="Enter your email address">
                  <button id="email-submit" type="submit" class="btn-custom" data-live-text-setting="section.footer.mailing_button_text">Subscribe</button>
                </form>
                {% form 'customer', id: 'contact-newsletter-footer' %}
                  {% if form.posted_successfully? %}
                    <p><em>{{ 'general.newsletter_form.thank_you' | t }}</em></p>
                  {% elsif form.errors %}
                    {% for field in form.errors %}
                      <p><em>{{ field }} - {{ form.errors.messages[field] }}</em></p>
                    {% endfor %}
                  {% endif %}

                  <input type="hidden" name="contact[accepts_marketing]" value="true">
                  <div class="input-group newsletter-form">
                    <input type="email" id="email_input_footer" class="input-group-field" aria-label="{{ 'general.newsletter_form.newsletter_email' | t }}" autocorrect="off" autocapitalize="off" name="contact[email]" />
                    <span class="input-group-btn">
                      <input type="submit" class="btn caps" name="subscribe" id="subscribe" value="{{ 'general.newsletter_form.submit' | t }}">
                    </span>
                  </div>
                {% endform %}
                {%- if isPopup -%}
                  <script type="text/javascript" src="//www.klaviyo.com/media/js/public/klaviyo_subscribe.js"></script>
                {%- endif -%}
              {% endcomment %}

              {%- assign klaviyo_url = block.settings.newsletter_url -%}
              {%- assign klaviyo_id  = block.settings.newsletter_url | split: 'g=' | last -%}
              {%- assign isPopup = true -%}

              <form action="{{klaviyo_url}}" class="contact-form" target="_blank" novalidate="novalidate">
                <input type="hidden" name="g" value="{{klaviyo_id}}">
                <div class="input-group newsletter-form">
                  <input type="email" id="email_input_footer" class="input-group-field" value="" name="email" class="contact_email" placeholder="{{ frmHolder }}" required autocorrect="off" autocapitalize="off" aria-label="{{ 'general.newsletter_form.newsletter_email' | t }}">

                  <span class="input-group-btn">
                    <input type="submit" class="btn caps" name="subscribe" id="subscribe" value="{{ 'general.newsletter_form.submit' | t }}">
                  </span>
                </div>

              </form>

            </div>

          {% else %}
        {% endcase %}
      {% endfor %}
    </div>

    <div class="footer-bottom">
    {% comment %} grid__item {% if section.settings.footer_payment_enable %}medium-up--two-thirds{% endif %} {% endcomment %}
      <div class="footer__secondary">
        <div class="left-content small--hide">
          {%- form 'localization', class: 'popout--footer' -%}
            {%- if section.settings.show_locale_selector and shop.published_locales.size > 0 -%}
              <div>
                <h2 class="visually-hidden" id="lang-heading">
                  {{ 'layout.footer.language' | t }}
                </h2>
                <div class="popout" data-popout-locale>
                  <button type="button" class="popout__toggle" aria-expanded="false" aria-controls="lang-list" aria-describedby="lang-heading" data-popout-toggle>
                    {{ form.current_locale.endonym_name }}
                    {%- render 'icon-select' -%}
                  </button>
                  <ul id="lang-list" class="popout-list" data-popout-list>
                    {% for locale in form.available_locales %}
                      <li class="popout-list__item {% if locale.iso_code == form.current_locale.iso_code %}popout-list__item--current{% endif %}">
                        <a class="popout-list__option" href="#" lang="{{ locale.iso_code }}" {% if locale.iso_code == form.current_locale.iso_code %}aria-current="true"{% endif %} data-value="{{ locale.iso_code }}" data-popout-option>
                          <span>{{ locale.endonym_name }}</span>
                        </a>
                      </li>
                    {%- endfor -%}
                  </ul>
                  <input type="hidden" name="locale_code" id="LocaleSelector" value="{{ form.current_locale.iso_code }}" data-popout-input/>
                </div>
              </div>
            {%- endif -%}

            {%- if section.settings.show_currency_selector and shop.enabled_currencies.size > 1 -%}
              <div>
                <h2 class="visually-hidden" id="currency-heading">
                  {{ 'layout.footer.currency' | t }}
                </h2>
                <div class="popout" data-popout-currency>
                  <button type="button" class="popout__toggle" aria-expanded="false" aria-controls="currency-list" aria-describedby="currency-heading" data-popout-toggle>
                    {{ form.current_currency.iso_code }} {%- if form.current_currency.symbol -%}{{ form.current_currency.symbol }}{%- endif -%}
                    {%- render 'icon-select' -%}
                  </button>
                  <ul id="currency-list" class="popout-list" data-popout-list>
                    {% for currency in form.available_currencies %}
                      <li class="popout-list__item {% if currency.iso_code == form.current_currency.iso_code %}popout-list__item--current{% endif %}">
                        <a class="popout-list__option" href="#" {% if currency.iso_code == form.current_currency.iso_code %}aria-current="true"{% endif %} data-value="{{ currency.iso_code }}" data-popout-option>
                          <span>{{ currency.iso_code }} {%- if currency.symbol -%}{{ currency.symbol }}{%- endif -%}</span>
                        </a>
                      </li>
                    {%- endfor -%}
                  </ul>
                  <input type="hidden" name="currency_code" id="CurrencySelector" value="{{ form.current_currency.iso_code }}" data-popout-input/>
                </div>
              </div>
            {%- endif -%}
          {%- endform -%}

          <ul class="footer__secondary__nav">
            {% for link in linklists[section.settings.footer_secondary_linklist].links %}
              <li><a href="{{ link.url }}">{{ link.title }}</a></li>
            {% endfor %}
          </ul>
        </div>

        <div class="right-content">
          {% if section.settings.footer_payment_enable %}
            {% unless shop.enabled_payment_types == empty %}
            {% comment %} grid__item inline-list grid__item medium-up--one-third {% endcomment %}
              <ul class="footer__payment payment-icons">
                {% for type in shop.enabled_payment_types %}
                  <li>{{ type | payment_type_svg_tag: class:'payment-icon' }}</li>
                {% endfor %}
              </ul>
            {% endunless %}
          {% endif %}
          {%- if section.settings.show_copyright -%}
            <div class="copyright"><span class="text">{{section.settings.copyright_text}}</span><a href="{{ shop.secure_url }}">&copy;{{ 'now' | date: "%Y" }} {{ shop.name }} </a></div>
          {%- endif -%}
        </div>

        {% comment %} <ul class="footer__copyright inline-list unstyled visually-hidden">
          <li>
            <a href="{{ shop.secure_url }}">&copy; {{ shop.name }} {{ 'now' | date: "%Y" }}</a>
          </li>
          {% for link in linklists[section.settings.footer_secondary_linklist].links %}
            <li><a href="{{ link.url }}">{{ link.title }}</a></li>
          {% endfor %}

          <!-- Remove the following line to delete Shopify credit -->
          <li data-powered-link>{{ powered_by_link }}</li>

        </ul> {% endcomment %}

      </div>


    </div>
  </div>

  {% if section.settings.image %}
    {% assign overlay_opacity = section.settings.overlay_opacity | prepend: '.' %}
    <div class="image-overlay" style="background-color:{{ section.settings.overlay_color }} !important; opacity:{{ overlay_opacity }};"></div>
  {% endif %}
</footer>

{% schema %}
{
  "name": "Footer",
  "max_blocks": 4,
  "settings": [
    {
      "label": "Footer logo",
      "type": "image_picker",
      "id": "footer_logo",
      "info": "400 x 200px .png"
    },
    {
      "type": "range",
      "id": "logo_image_width",
      "label": "Logo width (in pixels)",
      "min": 50,
      "max": 400,
      "step": 10,
      "unit": "px",
      "default": 150
    },
    {
      "type": "header",
      "content": "Optional background image"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Opacity",
      "min": 0,
      "max": 90,
      "step": 5,
      "unit": "%",
      "default": 15
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "default": "#000"
    },
    {
      "type": "header",
      "content": "Bottom bar"
    },
    {
      "type": "link_list",
      "id": "footer_secondary_linklist",
      "label": "Link List",
      "info": "This menu won't show dropdown items"
    },
    {
      "type": "checkbox",
      "id": "footer_payment_enable",
      "label": "Show payment types",
      "default": true
    },
    {
      "type": "header",
      "content": "language selector",
      "info": "To add a language, go to your [language settings.](/admin/settings/languages)"
    },
    {
      "type": "checkbox",
      "id": "show_locale_selector",
      "label": "Show language selector",
      "default": true
    },
    {
      "type": "header",
      "content": "Currency selector",
      "info": "To add a currency, go to your [payment settings.](/admin/settings/payments)"
    },
    {
      "type": "checkbox",
      "id": "show_currency_selector",
      "label": "Show currency selector",
      "default": true
    },
    {
      "type": "header",
      "content": {
        "en": "Copyright"
      }
    },
    {
      "type" : "checkbox",
      "id" : "show_copyright",
      "label" : {
        "en": "Show copyright"
      }
    },
    {
      "type": "text",
      "id": "copyright_text",
      "label": {
        "en": "Text"
      }
    }
  ],
  "blocks" : [
    {
      "type": "linklist",
      "name": "Link list",
      "settings": [
        {
          "type": "select",
          "id": "content_align",
          "label" : {
            "en" : "Content align"
          },
          "options": [
           {
              "value": "left",
              "label": {
                "en": "Left"
              }
           },
           {
             "value": "center",
             "label": {
               "en": "Center"
             }
           },
           {
             "value": "right",
             "label": {
               "en": "Right"
             }
           }
          ],
          "default" : "center"
        },
        {
          "type" : "range",
          "id": "order",
          "label": {
            "en" : "Order"
          },
          "step": 1,
          "min" : 1,
          "max" : 4,
          "default" : 1,
          "info": {
            "en": "Only works on mobile"
          }
        },
        {
          "type": "link_list",
          "id": "linklist",
          "label": "Link list",
          "default": "footer",
          "info": "This menu won't show dropdown items"
        }
      ]
    },
    {
      "type": "newsletter",
      "name": "Newsletter",
      "limit": 1,
      "settings": [
        {
          "type": "paragraph",
          "content": {
            "en": "Klaviyo: [Sign up](https:\/\/www.klaviyo.com\/register)"
          }
        },
       {
          "type": "select",
          "id": "content_align",
          "label" : {
            "en" : "Content align"
          },
          "options": [
           {
              "value": "left",
              "label": {
                "en": "Left"
              }
           },
           {
             "value": "center",
             "label": {
               "en": "Center"
             }
           },
           {
             "value": "right",
             "label": {
               "en": "Right"
             }
           }
          ],
          "default" : "center"
        },
        {
          "type" : "range",
          "id": "order",
          "label": {
            "en" : "Order"
          },
          "step": 1,
          "min" : 1,
          "max" : 4,
          "default" : 1,
          "info": {
            "en": "Only works on mobile"
          }
        },
        {
          "id": "richtext",
          "type": "richtext",
          "label": "Newsletter description",
          "default": "<p>Subscribe to get special offers, free giveaways, and once-in-a-lifetime deals.</p>"
        },
        {
          "type" : "textarea",
          "id" : "newsletter_url",
          "label" : {
            "en" : "Newsletter URL"
          }
        }
      ]
    },
    {
      "type": "social",
      "name": "Social",
      "settings": [
        {
          "type": "select",
          "id": "content_align",
          "label" : {
            "en" : "Content align"
          },
          "options": [
           {
              "value": "left",
              "label": {
                "en": "Left"
              }
           },
           {
             "value": "center",
             "label": {
               "en": "Center"
             }
           },
           {
             "value": "right",
             "label": {
               "en": "Right"
             }
           }
          ],
          "default" : "center"
        },
        {
          "type" : "range",
          "id": "order",
          "label": {
            "en" : "Order"
          },
          "step": 1,
          "min" : 1,
          "max" : 4,
          "default" : 1,
          "info": {
            "en": "Only works on mobile"
          }
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Social"
        },
        {
          "type": "richtext",
          "id": "richtext",
          "label": "Text",
          "default": "<p></p>"
        }
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "select",
          "id": "content_align",
          "label" : {
            "en" : "Content align"
          },
          "options": [
           {
              "value": "left",
              "label": {
                "en": "Left"
              }
           },
           {
             "value": "center",
             "label": {
               "en": "Center"
             }
           },
           {
             "value": "right",
             "label": {
               "en": "Right"
             }
           }
          ],
          "default" : "center"
        },
        {
          "type" : "range",
          "id": "order",
          "label": {
            "en" : "Order"
          },
          "step": 1,
          "min" : 1,
          "max" : 4,
          "default" : 1,
          "info": {
            "en": "Only works on mobile"
          }
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Text"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text",
          "default": "<p>Share store details, promotions, or brand content with your customers.</p>"
        }
      ]
    },
    {
      "type": "page",
      "name": "Page",
      "settings": [
          {
          "type": "select",
          "id": "content_align",
          "label" : {
            "en" : "Content align"
          },
          "options": [
           {
              "value": "left",
              "label": {
                "en": "Left"
              }
           },
           {
             "value": "center",
             "label": {
               "en": "Center"
             }
           },
           {
             "value": "right",
             "label": {
               "en": "Right"
             }
           }
          ],
          "default" : "center"
        },
        {
          "type" : "range",
          "id": "order",
          "label": {
            "en" : "Order"
          },
          "step": 1,
          "min" : 1,
          "max" : 4,
          "default" : 1,
          "info": {
            "en": "Only works on mobile"
          }
        },
        {
          "id": "page",
          "type": "page",
          "label": "Page"
        }
      ]
    }
  ]
}
{% endschema %}
